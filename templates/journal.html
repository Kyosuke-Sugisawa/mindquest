{% extends "base.html" %}

{% block title %}æ—¥è¨˜ã‚’æ›¸ã{% endblock %}

{% block content %}
<div class="container">
    <h1>ğŸ“ æ—¥è¨˜ã‚’æ›¸ã</h1>

    <form method="POST" action="/journal">
        <textarea name="content" rows="8" cols="50" placeholder="ä»Šæ—¥æ„Ÿã˜ãŸã“ã¨ã‚„è€ƒãˆãŸã“ã¨ã‚’æ›¸ã„ã¦ã¿ã‚ˆã†..." required></textarea><br>
        <button type="submit">ä¿å­˜ã™ã‚‹</button>
    </form>

    <form method="POST" action="/journal/analyze">
        <button type="submit" style="margin-top: 1em;">ğŸ§  AIã«åˆ†æã—ã¦ã‚‚ã‚‰ã†</button>
    </form>

    {% if analysis %}
    <div style="margin-top: 2em; background: #f7f7f7; padding: 1em; border-radius: 8px;">
        <h3>ğŸ§  AIã‹ã‚‰ã®ã‚³ãƒ¡ãƒ³ãƒˆ</h3>
        <p>{{ analysis }}</p>
    </div>
    {% endif %}

    <h2 style="margin-top: 2em;">ğŸ—‚ éå»ã®æ—¥è¨˜</h2>
    <ul>
        {% for entry in entries %}
        <li>
            <strong>{{ entry.created_at }}</strong><br>
            {{ entry.content|e }}<br>
            {% if entry.feedback %}
                <div style="margin-top: 0.5em; background: #eef; padding: 0.5em; border-radius: 5px;">
                    <em>ğŸ§  AIã‚³ãƒ¡ãƒ³ãƒˆï¼š</em> {{ entry.feedback }}
                </div>
            {% endif %}
            <form method="POST" action="/journal/delete" style="display:inline;">
                <input type="hidden" name="entry_id" value="{{ entry.id }}">
                <button type="submit" style="font-size: 0.8em; color: red; border: none; background: none; cursor: pointer;">ğŸ—‘ï¸ å‰Šé™¤</button>
            </form>
        </li>
        {% endfor %}
    </ul>
</div>
{% endblock %}
